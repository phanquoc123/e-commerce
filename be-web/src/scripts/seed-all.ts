import { MysqlDataSource } from '../configs/typeorm.config';
import { CategoryEntity } from '../modules/categories/entities/categories.entity';
import { ColorEntity } from '../modules/colors/entities/colors.entity';
import { ProductSizeEntity } from '../modules/product-sizes/entities/product-sizes.entity';
import { ProductEntity } from '../modules/products/entities/products.entity';
import { CollectionEntity } from '../modules/collections/entities/collections.entity';
import { ProductColorEntity } from '../modules/product-colors/entities/product-colors.entity';
import { ProductVariantEntity } from '../modules/product-variants/entities/product-variants.entity';
import { ProductImageEntity } from '../modules/product-images/entities/product-images.entity';
import { CollectionProductEntity } from '../modules/collection-products/entities/collection-products.entity';

async function seedAll() {
  const dataSource = MysqlDataSource;

  try {
    console.log('üöÄ Starting seed process...\n');
    await dataSource.initialize();
    console.log('üîå Database connection established\n');

    // ============ CLEAR EXISTING DATA ============
    console.log('üóëÔ∏è  Clearing existing data...');
    const categoryRepository = dataSource.getRepository(CategoryEntity);
    
    await categoryRepository.query('SET FOREIGN_KEY_CHECKS = 0');
    await categoryRepository.query('TRUNCATE TABLE `collection_products`');
    await categoryRepository.query('TRUNCATE TABLE `product_images`');
    await categoryRepository.query('TRUNCATE TABLE `product_variants`');
    await categoryRepository.query('TRUNCATE TABLE `product_colors`');
    await categoryRepository.query('TRUNCATE TABLE `products`');
    await categoryRepository.query('TRUNCATE TABLE `collections`');
    await categoryRepository.query('TRUNCATE TABLE `categories`');
    await categoryRepository.query('TRUNCATE TABLE `colors`');
    await categoryRepository.query('TRUNCATE TABLE `product_sizes`');
    await categoryRepository.query('SET FOREIGN_KEY_CHECKS = 1');
    console.log('‚úÖ Existing data cleared!\n');

    // ============ SEED CATEGORIES ============
    console.log('üìÅ Seeding Categories...');

    const colorRepository = dataSource.getRepository(ColorEntity);
    const sizeRepository = dataSource.getRepository(ProductSizeEntity);
    const productRepository = dataSource.getRepository(ProductEntity);
    const collectionRepository = dataSource.getRepository(CollectionEntity);
    const productColorRepository = dataSource.getRepository(ProductColorEntity);
    const productVariantRepository = dataSource.getRepository(ProductVariantEntity);
    const productImageRepository = dataSource.getRepository(ProductImageEntity);
    const collectionProductRepository = dataSource.getRepository(CollectionProductEntity);

    const categoriesToSeed = [
      // Root Categories
      {
        name: 'Nam',
        slug: 'nam',
        thumbnail: 'https://images.unsplash.com/photo-1490114538077-0a7f8cb49891',
        parentId: null,
        isActive: true,
        sortOrder: 1,
      },
      {
        name: 'N·ªØ',
        slug: 'nu',
        thumbnail: 'https://images.unsplash.com/photo-1483985988355-763728e1935b',
        parentId: null,
        isActive: true,
        sortOrder: 2,
      },
      {
        name: 'Tr·∫ª em',
        slug: 'tre-em',
        thumbnail: 'https://images.unsplash.com/photo-1503919545889-aef636e10ad4',
        parentId: null,
        isActive: true,
        sortOrder: 3,
      },
      {
        name: 'Ph·ª• ki·ªán',
        slug: 'phu-kien',
        thumbnail: 'https://images.unsplash.com/photo-1523398002811-999ca8dec234',
        parentId: null,
        isActive: true,
        sortOrder: 4,
      },
    ];

    const savedCategories: any = {};
    for (const catData of categoriesToSeed) {
      const newCategory = categoryRepository.create(catData);
      const savedCat = await categoryRepository.save(newCategory);
      savedCategories[catData.name] = savedCat.id;
    }

    // Child Categories for Nam
    const namId = savedCategories['Nam'];
    const childCategoriesNam = [
      {
        name: '√Åo nam',
        slug: 'ao-nam',
        thumbnail: 'https://images.unsplash.com/photo-1602810318383-e386cc2a3ccf',
        parentId: namId,
        isActive: true,
        sortOrder: 1,
      },
      {
        name: 'Qu·∫ßn nam',
        slug: 'quan-nam',
        thumbnail: 'https://images.unsplash.com/photo-1473966968600-fa801b869a1a',
        parentId: namId,
        isActive: true,
        sortOrder: 2,
      },
      {
        name: 'Gi√†y nam',
        slug: 'giay-nam',
        thumbnail: 'https://images.unsplash.com/photo-1549298916-b41d501d3772',
        parentId: namId,
        isActive: true,
        sortOrder: 3,
      },
      {
        name: '√Åo kho√°c nam',
        slug: 'ao-khoac-nam',
        thumbnail: 'https://images.unsplash.com/photo-1551028719-00167b16eac5',
        parentId: namId,
        isActive: true,
        sortOrder: 4,
      },
    ];
    for (const catData of childCategoriesNam) {
      const newCategory = categoryRepository.create(catData);
      const savedCat = await categoryRepository.save(newCategory);
      savedCategories[catData.name] = savedCat.id;
    }

    // Child Categories for N·ªØ
    const nuId = savedCategories['N·ªØ'];
    const childCategoriesNu = [
      {
        name: '√Åo n·ªØ',
        slug: 'ao-nu',
        thumbnail: 'https://images.unsplash.com/photo-1485968579580-b6d095142e6e',
        parentId: nuId,
        isActive: true,
        sortOrder: 1,
      },
      {
        name: 'Qu·∫ßn n·ªØ',
        slug: 'quan-nu',
        thumbnail: 'https://images.unsplash.com/photo-1506629082955-511b1aa562c8',
        parentId: nuId,
        isActive: true,
        sortOrder: 2,
      },
      {
        name: 'V√°y n·ªØ',
        slug: 'vay-nu',
        thumbnail: 'https://images.unsplash.com/photo-1595777457583-95e059d581b8',
        parentId: nuId,
        isActive: true,
        sortOrder: 3,
      },
      {
        name: 'ƒê·∫ßm n·ªØ',
        slug: 'dam-nu',
        thumbnail: 'https://images.unsplash.com/photo-1566174053879-31528523f8ae',
        parentId: nuId,
        isActive: true,
        sortOrder: 4,
      },
    ];
    for (const catData of childCategoriesNu) {
      const newCategory = categoryRepository.create(catData);
      const savedCat = await categoryRepository.save(newCategory);
      savedCategories[catData.name] = savedCat.id;
    }

    // Grandchild Categories for √Åo nam
    const aoNamId = savedCategories['√Åo nam'];
    const grandchildCategoriesAoNam = [
      {
        name: '√Åo thun nam',
        slug: 'ao-thun-nam',
        thumbnail: 'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab',
        parentId: aoNamId,
        isActive: true,
        sortOrder: 1,
      },
      {
        name: '√Åo s∆° mi nam',
        slug: 'ao-so-mi-nam',
        thumbnail: 'https://images.unsplash.com/photo-1596755094514-f87e34085b2c',
        parentId: aoNamId,
        isActive: true,
        sortOrder: 2,
      },
      {
        name: '√Åo polo nam',
        slug: 'ao-polo-nam',
        thumbnail: 'https://images.unsplash.com/photo-1626497764746-6dc36546b388',
        parentId: aoNamId,
        isActive: true,
        sortOrder: 3,
      },
    ];
    for (const catData of grandchildCategoriesAoNam) {
      const newCategory = categoryRepository.create(catData);
      await categoryRepository.save(newCategory);
    }

    console.log('‚úÖ Categories seeded successfully!\n');

    // ============ SEED COLORS ============
    console.log('üé® Seeding Colors...');

    const colorsToSeed = [
      {
        name: 'ƒê·ªè',
        code: 'red',
        hexCode: '#FF0000',
        thumbnailUrl: 'https://via.placeholder.com/50/FF0000/FFFFFF?text=R',
      },
      {
        name: 'Xanh d∆∞∆°ng',
        code: 'blue',
        hexCode: '#0000FF',
        thumbnailUrl: 'https://via.placeholder.com/50/0000FF/FFFFFF?text=B',
      },
      {
        name: 'Xanh l√°',
        code: 'green',
        hexCode: '#00FF00',
        thumbnailUrl: 'https://via.placeholder.com/50/00FF00/FFFFFF?text=G',
      },
      {
        name: 'V√†ng',
        code: 'yellow',
        hexCode: '#FFFF00',
        thumbnailUrl: 'https://via.placeholder.com/50/FFFF00/000000?text=Y',
      },
      {
        name: 'Cam',
        code: 'orange',
        hexCode: '#FFA500',
        thumbnailUrl: 'https://via.placeholder.com/50/FFA500/FFFFFF?text=O',
      },
      {
        name: 'T√≠m',
        code: 'purple',
        hexCode: '#800080',
        thumbnailUrl: 'https://via.placeholder.com/50/800080/FFFFFF?text=P',
      },
      {
        name: 'H·ªìng',
        code: 'pink',
        hexCode: '#FFC0CB',
        thumbnailUrl: 'https://via.placeholder.com/50/FFC0CB/000000?text=Pi',
      },
      {
        name: 'ƒêen',
        code: 'black',
        hexCode: '#000000',
        thumbnailUrl: 'https://via.placeholder.com/50/000000/FFFFFF?text=Bl',
      },
      {
        name: 'Tr·∫Øng',
        code: 'white',
        hexCode: '#FFFFFF',
        thumbnailUrl: 'https://via.placeholder.com/50/FFFFFF/000000?text=W',
      },
      {
        name: 'X√°m',
        code: 'gray',
        hexCode: '#808080',
        thumbnailUrl: 'https://via.placeholder.com/50/808080/FFFFFF?text=Gr',
      },
      {
        name: 'Navy',
        code: 'navy',
        hexCode: '#000080',
        thumbnailUrl: 'https://via.placeholder.com/50/000080/FFFFFF?text=N',
      },
      {
        name: 'Be',
        code: 'beige',
        hexCode: '#F5F5DC',
        thumbnailUrl: 'https://via.placeholder.com/50/F5F5DC/000000?text=Be',
      },
    ];

    const savedColors: any = {};
    for (const colorData of colorsToSeed) {
      const color = colorRepository.create(colorData);
      const savedColor = await colorRepository.save(color);
      savedColors[colorData.code] = savedColor.id;
    }
    console.log('‚úÖ Colors seeded successfully!\n');

    // ============ SEED PRODUCT SIZES ============
    console.log('üìè Seeding Product Sizes...');

    const sizesToSeed = [
      { name: 'XS', code: 'xs' },
      { name: 'S', code: 's' },
      { name: 'M', code: 'm' },
      { name: 'L', code: 'l' },
      { name: 'XL', code: 'xl' },
      { name: 'XXL', code: 'xxl' },
      { name: '2XL', code: '2xl' },
      { name: '3XL', code: '3xl' },
      { name: 'Free Size', code: 'free' },
    ];

    const savedSizes: any = {};
    for (const sizeData of sizesToSeed) {
      const size = sizeRepository.create(sizeData);
      const savedSize = await sizeRepository.save(size);
      savedSizes[sizeData.code] = savedSize.id;
    }
    console.log('‚úÖ Product Sizes seeded successfully!\n');

    // ============ SEED PRODUCTS ============
    console.log('üõçÔ∏è  Seeding Products...');

    const aoThunNam = await categoryRepository.findOne({
      where: { slug: 'ao-thun-nam' },
    });
    const aoSoMiNam = await categoryRepository.findOne({
      where: { slug: 'ao-so-mi-nam' },
    });
    const quanNam = await categoryRepository.findOne({
      where: { slug: 'quan-nam' },
    });
    const aoNu = await categoryRepository.findOne({
      where: { slug: 'ao-nu' },
    });
    const damNu = await categoryRepository.findOne({
      where: { slug: 'dam-nu' },
    });

    const productsToSeed = [
      // √Åo thun nam
      {
        categoryId: aoThunNam?.id || 1,
        name: '√Åo thun nam basic cotton Premium',
        slug: 'ao-thun-nam-basic-cotton-premium',
        description: '√Åo thun nam ch·∫•t li·ªáu cotton 100% cao c·∫•p, form regular fit tho·∫£i m√°i, th·∫•m h√∫t m·ªì h√¥i t·ªët.',
        price: 199000,
        salePrice: 149000,
        isActive: true,
      },
      {
        categoryId: aoThunNam?.id || 1,
        name: '√Åo thun nam Polo tr∆°n',
        slug: 'ao-thun-nam-polo-tron',
        description: '√Åo polo nam sang tr·ªçng, c·ªï b·∫ª ph·ªëi vi·ªÅn, th√≠ch h·ª£p ƒëi l√†m v√† d·∫°o ph·ªë.',
        price: 299000,
        salePrice: 249000,
        isActive: true,
      },
      {
        categoryId: aoThunNam?.id || 1,
        name: '√Åo thun nam oversize form r·ªông',
        slug: 'ao-thun-nam-oversize-form-rong',
        description: '√Åo thun nam form oversize trendy, ph√π h·ª£p phong c√°ch streetwear.',
        price: 249000,
        salePrice: null,
        isActive: true,
      },
      {
        categoryId: aoThunNam?.id || 1,
        name: '√Åo thun nam c·ªï tr√≤n Premium Basics',
        slug: 'ao-thun-nam-co-tron-premium-basics',
        description: '√Åo thun basic thi·∫øt k·∫ø t·ªëi gi·∫£n, ch·∫•t v·∫£i m·ªÅm m·∫°i, co gi√£n nh·∫π.',
        price: 179000,
        salePrice: 139000,
        isActive: true,
      },
      // √Åo s∆° mi nam
      {
        categoryId: aoSoMiNam?.id || 1,
        name: '√Åo s∆° mi nam d√†i tay c√¥ng s·ªü',
        slug: 'ao-so-mi-nam-dai-tay-cong-so',
        description: '√Åo s∆° mi nam d√†i tay ch·∫•t v·∫£i cao c·∫•p, ch·ªëng nhƒÉn, ph√π h·ª£p m√¥i tr∆∞·ªùng c√¥ng s·ªü.',
        price: 399000,
        salePrice: 349000,
        isActive: true,
      },
      {
        categoryId: aoSoMiNam?.id || 1,
        name: '√Åo s∆° mi nam Oxford cao c·∫•p',
        slug: 'ao-so-mi-nam-oxford-cao-cap',
        description: '√Åo s∆° mi v·∫£i Oxford d√†y d·∫∑n, form slim fit thanh l·ªãch.',
        price: 449000,
        salePrice: null,
        isActive: true,
      },
      // Qu·∫ßn nam
      {
        categoryId: quanNam?.id || 1,
        name: 'Qu·∫ßn jean nam slim fit xanh ƒë·∫≠m',
        slug: 'quan-jean-nam-slim-fit-xanh-dam',
        description: 'Qu·∫ßn jean nam form slim fit √¥m v·ª´a v·∫∑n, ch·∫•t v·∫£i denim co gi√£n nh·∫π.',
        price: 499000,
        salePrice: 399000,
        isActive: true,
      },
      {
        categoryId: quanNam?.id || 1,
        name: 'Qu·∫ßn kaki nam c√¥ng s·ªü Regular Fit',
        slug: 'quan-kaki-nam-cong-so-regular-fit',
        description: 'Qu·∫ßn kaki nam ch·∫•t v·∫£i cao c·∫•p, form regular tho·∫£i m√°i, ph√π h·ª£p ƒëi l√†m.',
        price: 379000,
        salePrice: 329000,
        isActive: true,
      },
      {
        categoryId: quanNam?.id || 1,
        name: 'Qu·∫ßn jogger nam th·ªÉ thao',
        slug: 'quan-jogger-nam-the-thao',
        description: 'Qu·∫ßn jogger nam form th·ªÉ thao, ch·∫•t v·∫£i thun co gi√£n t·ªët, tho·∫£i m√°i v·∫≠n ƒë·ªông.',
        price: 299000,
        salePrice: null,
        isActive: true,
      },
      // N·ªØ
      {
        categoryId: aoNu?.id || 2,
        name: '√Åo thun n·ªØ basic form fitted',
        slug: 'ao-thun-nu-basic-form-fitted',
        description: '√Åo thun n·ªØ form fitted √¥m d√°ng, ch·∫•t cotton m·ªÅm m·∫°i.',
        price: 179000,
        salePrice: 149000,
        isActive: true,
      },
      {
        categoryId: aoNu?.id || 2,
        name: '√Åo ki·ªÉu n·ªØ tay b·ªìng vintage',
        slug: 'ao-kieu-nu-tay-bong-vintage',
        description: '√Åo ki·ªÉu n·ªØ thi·∫øt k·∫ø tay b·ªìng ƒëi·ªáu ƒë√†, phong c√°ch vintage.',
        price: 259000,
        salePrice: 219000,
        isActive: true,
      },
      {
        categoryId: aoNu?.id || 2,
        name: '√Åo croptop n·ªØ tr·∫ª trung nƒÉng ƒë·ªông',
        slug: 'ao-croptop-nu-tre-trung-nang-dong',
        description: '√Åo croptop n·ªØ form ng·∫Øn trendy, ph·ªëi ƒë·ªì ƒëa d·∫°ng.',
        price: 159000,
        salePrice: null,
        isActive: true,
      },
      // ƒê·∫ßm n·ªØ
      {
        categoryId: damNu?.id || 2,
        name: 'V√°y ƒë·∫ßm n·ªØ babydoll d·ªÖ th∆∞∆°ng',
        slug: 'vay-dam-nu-babydoll-de-thuong',
        description: 'V√°y ƒë·∫ßm babydoll xinh x·∫Øn, thi·∫øt k·∫ø x√≤e nh·∫π, ph√π h·ª£p d·∫°o ph·ªë.',
        price: 349000,
        salePrice: 299000,
        isActive: true,
      },
      {
        categoryId: damNu?.id || 2,
        name: 'ƒê·∫ßm maxi n·ªØ d√†i elegant',
        slug: 'dam-maxi-nu-dai-elegant',
        description: 'ƒê·∫ßm maxi d√†i thanh l·ªãch, th√≠ch h·ª£p d·ª± ti·ªác v√† s·ª± ki·ªán.',
        price: 599000,
        salePrice: 499000,
        isActive: true,
      },
      {
        categoryId: damNu?.id || 2,
        name: 'ƒê·∫ßm su√¥ng n·ªØ c√¥ng s·ªü',
        slug: 'dam-suong-nu-cong-so',
        description: 'ƒê·∫ßm su√¥ng n·ªØ form A ƒë∆°n gi·∫£n, ph√π h·ª£p m√¥i tr∆∞·ªùng c√¥ng s·ªü.',
        price: 429000,
        salePrice: null,
        isActive: true,
      },
    ];

    const savedProducts: any[] = [];
    for (const productData of productsToSeed) {
      const product = productRepository.create(productData);
      const savedProduct = await productRepository.save(product);
      savedProducts.push(savedProduct);
    }
    console.log('‚úÖ Products seeded successfully!\n');

    // ============ SEED PRODUCT COLORS ============
    console.log('üåà Seeding Product Colors (linking products with colors)...');

    const productColorsToSeed: any[] = [];

    // M·ªói s·∫£n ph·∫©m c√≥ 2-4 m√†u
    for (const product of savedProducts) {
      const productIndex = savedProducts.indexOf(product);
      
      if (productIndex % 3 === 0) {
        // S·∫£n ph·∫©m 0, 3, 6, 9, 12: ƒêen, Tr·∫Øng, X√°m, Navy
        productColorsToSeed.push(
          { productId: product.id, colorId: savedColors['black'] },
          { productId: product.id, colorId: savedColors['white'] },
          { productId: product.id, colorId: savedColors['gray'] },
          { productId: product.id, colorId: savedColors['navy'] },
        );
      } else if (productIndex % 3 === 1) {
        // S·∫£n ph·∫©m 1, 4, 7, 10, 13: Xanh, ƒê·ªè, Be
        productColorsToSeed.push(
          { productId: product.id, colorId: savedColors['blue'] },
          { productId: product.id, colorId: savedColors['red'] },
          { productId: product.id, colorId: savedColors['beige'] },
        );
      } else {
        // S·∫£n ph·∫©m 2, 5, 8, 11, 14: ƒêen, H·ªìng, T√≠m
        productColorsToSeed.push(
          { productId: product.id, colorId: savedColors['black'] },
          { productId: product.id, colorId: savedColors['pink'] },
          { productId: product.id, colorId: savedColors['purple'] },
        );
      }
    }

    const savedProductColors: any[] = [];
    for (const pcData of productColorsToSeed) {
      const productColor = productColorRepository.create(pcData);
      const savedPC = await productColorRepository.save(productColor);
      savedProductColors.push(savedPC);
    }
    console.log('‚úÖ Product Colors seeded successfully!\n');

    // ============ SEED PRODUCT IMAGES ============
    console.log('üñºÔ∏è  Seeding Product Images (for each color)...');

    const imagesToSeed: any[] = [];

    for (const productColor of savedProductColors) {
      const colorCode = Object.keys(savedColors).find(
        (key) => savedColors[key] === productColor.colorId,
      );
      const hexCode =
        colorsToSeed.find((c) => c.code === colorCode)?.hexCode || '808080';

      // M·ªói m√†u c√≥ 3-4 ·∫£nh
      imagesToSeed.push(
        {
          productColorId: productColor.id,
          imageUrl: `https://via.placeholder.com/800/${hexCode.slice(1)}/FFFFFF?text=Main+Image`,
          isMain: true,
          sortOrder: 1,
        },
        {
          productColorId: productColor.id,
          imageUrl: `https://via.placeholder.com/800/${hexCode.slice(1)}/FFFFFF?text=Image+2`,
          isMain: false,
          sortOrder: 2,
        },
        {
          productColorId: productColor.id,
          imageUrl: `https://via.placeholder.com/800/${hexCode.slice(1)}/FFFFFF?text=Image+3`,
          isMain: false,
          sortOrder: 3,
        },
      );
    }

    for (const imageData of imagesToSeed) {
      const image = productImageRepository.create(imageData);
      await productImageRepository.save(image);
    }
    console.log('‚úÖ Product Images seeded successfully!\n');

    // ============ SEED PRODUCT VARIANTS ============
    console.log('üîÄ Seeding Product Variants (color + size combinations)...');

    const variantsToSeed: any[] = [];

    // T·∫°o variants cho m·ªói product color v·ªõi c√°c size kh√°c nhau
    for (const productColor of savedProductColors) {
      const product = savedProducts.find((p) => p.id === productColor.productId);
      if (!product) continue;

      // M·ªói m√†u c√≥ 3-4 size
      const sizeCodes = ['s', 'm', 'l', 'xl'];
      
      for (const sizeCode of sizeCodes) {
        const sizeId = savedSizes[sizeCode];
        if (!sizeId) continue;

        const sku = `${product.slug}-${Object.keys(savedColors).find(k => savedColors[k] === productColor.colorId)}-${sizeCode}`.toUpperCase();
        
        variantsToSeed.push({
          productId: product.id,
          colorId: productColor.id,
          sizeId: sizeId,
          sku: sku,
          price: product.price,
          stock: Math.floor(Math.random() * 100) + 20, // 20-120
          status: 'active',
        });
      }
    }

    for (const variantData of variantsToSeed) {
      const variant = productVariantRepository.create(variantData);
      await productVariantRepository.save(variant);
    }
    console.log('‚úÖ Product Variants seeded successfully!\n');

    // ============ SEED COLLECTIONS ============
    console.log('üì¶ Seeding Collections...');

    const collectionsToSeed = [
      {
        name: 'B·ªô s∆∞u t·∫≠p m√πa h√® 2024',
        slug: 'bo-suu-tap-mua-he-2024',
        description: 'B·ªô s∆∞u t·∫≠p th·ªùi trang m√πa h√® s√¥i ƒë·ªông, t∆∞∆°i m·ªõi v·ªõi nh·ªØng gam m√†u t∆∞∆°i s√°ng.',
        thumbnailUrl: 'https://images.unsplash.com/photo-1523381210434-271e8be1f52b',
        isActive: true,
      },
      {
        name: 'B·ªô s∆∞u t·∫≠p xu√¢n 2024',
        slug: 'bo-suu-tap-xuan-2024',
        description: 'B·ªô s∆∞u t·∫≠p xu√¢n ng·ªçt ng√†o v·ªõi nh·ªØng h·ªça ti·∫øt hoa l√°.',
        thumbnailUrl: 'https://images.unsplash.com/photo-1445205170230-053b83016050',
        isActive: true,
      },
      {
        name: 'B·ªô s∆∞u t·∫≠p c√¥ng s·ªü',
        slug: 'bo-suu-tap-cong-so',
        description: 'B·ªô s∆∞u t·∫≠p th·ªùi trang c√¥ng s·ªü l·ªãch s·ª±, chuy√™n nghi·ªáp.',
        thumbnailUrl: 'https://images.unsplash.com/photo-1490481651871-ab68de25d43d',
        isActive: true,
      },
      {
        name: 'B·ªô s∆∞u t·∫≠p Streetwear',
        slug: 'bo-suu-tap-streetwear',
        description: 'B·ªô s∆∞u t·∫≠p phong c√°ch ƒë∆∞·ªùng ph·ªë nƒÉng ƒë·ªông, c√° t√≠nh.',
        thumbnailUrl: 'https://images.unsplash.com/photo-1515886657613-9f3515b0c78f',
        isActive: true,
      },
      {
        name: 'B·ªô s∆∞u t·∫≠p Premium',
        slug: 'bo-suu-tap-premium',
        description: 'B·ªô s∆∞u t·∫≠p cao c·∫•p v·ªõi ch·∫•t li·ªáu v√† thi·∫øt k·∫ø ƒë·∫≥ng c·∫•p.',
        thumbnailUrl: 'https://images.unsplash.com/photo-1441984904996-e0b6ba687e04',
        isActive: true,
      },
    ];

    const savedCollections: any[] = [];
    for (const collectionData of collectionsToSeed) {
      const collection = collectionRepository.create(collectionData);
      const savedCollection = await collectionRepository.save(collection);
      savedCollections.push(savedCollection);
    }
    console.log('‚úÖ Collections seeded successfully!\n');

    // ============ SEED COLLECTION PRODUCTS ============
    console.log('üîó Seeding Collection Products...');

    const collectionProductsToSeed: any[] = [];

    // Ph√¢n ph·ªëi s·∫£n ph·∫©m v√†o collections
    if (savedCollections.length > 0 && savedProducts.length > 0) {
      // Summer collection - s·∫£n ph·∫©m 0-4
      for (let i = 0; i < Math.min(5, savedProducts.length); i++) {
        collectionProductsToSeed.push({
          collectionId: savedCollections[0].id,
          productId: savedProducts[i].id,
          sortOrder: i + 1,
        });
      }

      // Spring collection - s·∫£n ph·∫©m 3-7
      for (let i = 3; i < Math.min(8, savedProducts.length); i++) {
        collectionProductsToSeed.push({
          collectionId: savedCollections[1].id,
          productId: savedProducts[i].id,
          sortOrder: i - 2,
        });
      }

      // Office collection - s·∫£n ph·∫©m c√≥ s∆° mi, kaki
      [4, 5, 7, 14].forEach((idx, order) => {
        if (idx < savedProducts.length) {
          collectionProductsToSeed.push({
            collectionId: savedCollections[2].id,
            productId: savedProducts[idx].id,
            sortOrder: order + 1,
          });
        }
      });

      // Streetwear collection - s·∫£n ph·∫©m oversize, jogger
      [2, 8, 11].forEach((idx, order) => {
        if (idx < savedProducts.length) {
          collectionProductsToSeed.push({
            collectionId: savedCollections[3].id,
            productId: savedProducts[idx].id,
            sortOrder: order + 1,
          });
        }
      });

      // Premium collection - s·∫£n ph·∫©m cao c·∫•p
      [5, 6, 13, 14].forEach((idx, order) => {
        if (idx < savedProducts.length) {
          collectionProductsToSeed.push({
            collectionId: savedCollections[4].id,
            productId: savedProducts[idx].id,
            sortOrder: order + 1,
          });
        }
      });
    }

    for (const cpData of collectionProductsToSeed) {
      const collectionProduct = collectionProductRepository.create(cpData);
      await collectionProductRepository.save(collectionProduct);
    }
    console.log('‚úÖ Collection Products seeded successfully!\n');

    // ============ SUMMARY ============
    const totalCategories = await categoryRepository.count();
    const totalColors = await colorRepository.count();
    const totalSizes = await sizeRepository.count();
    const totalProducts = await productRepository.count();
    const totalProductColors = await productColorRepository.count();
    const totalVariants = await productVariantRepository.count();
    const totalImages = await productImageRepository.count();
    const totalCollections = await collectionRepository.count();
    const totalCollectionProducts = await collectionProductRepository.count();

    console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');
    console.log('üìä SEED SUMMARY:');
    console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');
    console.log(`üìÅ Categories: ${totalCategories}`);
    console.log(`üé® Colors (with hex codes): ${totalColors}`);
    console.log(`üìè Product Sizes: ${totalSizes}`);
    console.log(`üõçÔ∏è  Products: ${totalProducts}`);
    console.log(`üåà Product Colors: ${totalProductColors}`);
    console.log(`üîÄ Product Variants: ${totalVariants}`);
    console.log(`üñºÔ∏è  Product Images: ${totalImages}`);
    console.log(`üì¶ Collections: ${totalCollections}`);
    console.log(`üîó Collection Products: ${totalCollectionProducts}`);
    console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n');
    
    console.log('üí° Note: Carts and Orders will be created when users interact with the app.\n');
  } catch (error) {
    console.error('‚ùå Error seeding database:', error);
    throw error;
  } finally {
    await dataSource.destroy();
    console.log('üîå Database connection closed');
  }
}

seedAll().then(() => console.log('üéâ All seeds completed successfully!'));
